(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{323:function(e,t,o){"use strict";o.r(t);o(29);var r=o(2),n=o(267),c=o.n(n),l=(o(268),{components:{VuePhoneNumberInput:c.a},data:function(){return{codePage:!1,passwordPage:!1,code:null,successCode:!1,agreement:!1,withPhone:!1,validPhone:!1,email:null,phone:null,formattedPhone:null,password:null}},methods:{showAgreement:function(){this.codePage=!1,this.withPhone?this.passwordPage?this.$modal.show("agreement"):this.register("registration_code"):this.$modal.show("agreement")},hideAgreement:function(){this.$modal.hide("agreement")},isValidPhone:function(e){this.validPhone=!1,e.isValid&&(this.formattedPhone=e.formattedNumber,this.validPhone=!0)},register:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function o(){var r,n,c,l;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:o.t0=t.withPhone,o.next=!0===o.t0?3:!1===o.t0?32:45;break;case 3:if(!t.validPhone){o.next=30;break}if("registration_code"!==e){o.next=10;break}return r={jsonrpc:"2.0",method:e,params:{phone:t.formattedPhone}},o.next=8,t.$store.dispatch("auth/register",r);case 8:t.codePage=!0,t.$toast.success("Код успешно отправлен",{position:"bottom-center",duration:2e3});case 10:if("registration_code_check"!==e){o.next=16;break}return n={jsonrpc:"2.0",method:e,params:{phone:t.formattedPhone,code:t.code}},o.next=14,t.$store.dispatch("auth/register",n);case 14:o.sent?(t.codePage=!1,t.passwordPage=!0,t.$toast.success("Код успешно подтвержден",{position:"bottom-center",duration:2e3})):t.$toast.error("Неверный код",{position:"bottom-center",duration:2e3});case 16:if("registration"!==e){o.next=28;break}return o.prev=17,c={jsonrpc:"2.0",method:e,params:{phone:t.formattedPhone,password:t.password,agreement:!0}},o.next=21,t.$store.dispatch("auth/register",c);case 21:t.$toast.success("Регистрация успешно выполнена",{position:"bottom-center",duration:2e3}),t.$router.push("/login"),o.next=28;break;case 25:o.prev=25,o.t1=o.catch(17),t.$toast.error("Ошибка",{position:"bottom-center",duration:2e3});case 28:o.next=31;break;case 30:t.$toast.error("Неверный номер",{position:"bottom-center",duration:2e3});case 31:return o.abrupt("break",45);case 32:if("registration"!==e){o.next=44;break}return o.prev=33,l={jsonrpc:"2.0",method:e,params:{email:t.email,password:t.password,agreement:!0}},o.next=37,t.$store.dispatch("auth/register",l);case 37:t.$toast.success("Регистрация успешно выполнена",{position:"bottom-center",duration:2e3}),t.$router.push("/login"),o.next=44;break;case 41:o.prev=41,o.t2=o.catch(33),t.$toast.error("Ошибка",{position:"bottom-center",duration:2e3});case 44:return o.abrupt("break",45);case 45:case"end":return o.stop()}}),o,null,[[17,25],[33,41]])})))()}}}),d=o(28),component=Object(d.a)(l,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("section",{staticClass:"flex flex-auto text-gray-700"},[o("div",{staticClass:"container px-5 py-2 mx-auto flex justify-center items-center"},[e.codePage||e.passwordPage?e._e():o("form",{staticClass:"flex flex-col bg-gray-300 rounded-lg shadow-md p-2 md:p-8",on:{submit:function(t){return t.preventDefault(),e.showAgreement(t)}}},[o("h2",{staticClass:"mb-5"},[e._v("\n        Регистрация\n      ")]),e._v(" "),e.withPhone?o("div",[o("VuePhoneNumberInput",{staticClass:"mb-4",attrs:{autocomplete:"tel",color:"#48bb78","default-country-code":"RU","no-country-selector":"",translations:{phoneNumberLabel:"Телефон",example:"Пример:"},required:!0},on:{update:e.isValidPhone},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}})],1):o("div",{staticClass:"flex flex-col"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],staticClass:"input",attrs:{id:"email",autocomplete:"email",placeholder:"Почта *",type:"email",pattern:"[^@\\s]+@[^@\\s]+\\.[^@\\s]+",required:""},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"input",attrs:{id:"new-password",autocomplete:"new-password",placeholder:"Пароль *",type:"password",required:""},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})]),e._v(" "),o("label",{staticClass:"flex justify-center items-center cursor-pointer mb-4",attrs:{for:"toogle"}},[o("div",{staticClass:"relative"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.withPhone,expression:"withPhone"}],staticClass:"hidden",attrs:{id:"toogle",type:"checkbox"},domProps:{checked:Array.isArray(e.withPhone)?e._i(e.withPhone,null)>-1:e.withPhone},on:{change:function(t){var o=e.withPhone,r=t.target,n=!!r.checked;if(Array.isArray(o)){var c=e._i(o,null);r.checked?c<0&&(e.withPhone=o.concat([null])):c>-1&&(e.withPhone=o.slice(0,c).concat(o.slice(c+1)))}else e.withPhone=n}}}),e._v(" "),o("div",{staticClass:"toggle__line w-6 h-3 bg-gray-400 rounded-full shadow-inner"}),e._v(" "),o("div",{staticClass:"toggle__dot absolute w-3 h-3 bg-white rounded-full shadow"})]),e._v(" "),o("div",{staticClass:"ml-3 text-gray-700"},[e._v("\n          с помощью телефона\n        ")])]),e._v(" "),o("button",{staticClass:"btn btn-primary text-lg mb-5"},[e._v("\n        Зарегистрироваться\n      ")]),e._v(" "),o("p",{staticClass:"text-xs text-gray-500 mt-3"},[e._v("\n        Уже зарегистрированы?\n        "),o("nuxt-link",{staticClass:"text-gray-700",attrs:{to:"/login"}},[e._v("Войти")])],1)]),e._v(" "),e.codePage?o("form",{staticClass:"flex flex-col bg-gray-300 rounded-lg shadow-md p-2 md:p-8",on:{submit:function(t){return t.preventDefault(),e.register("registration_code_check")}}},[o("h2",{staticClass:"mb-5"},[e._v("\n        Введите код подтверждения\n      ")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.code,expression:"code"}],staticClass:"input",attrs:{id:"one-time-code",autocomplete:"one-time-code",placeholder:"Код подтверждения",type:"text",required:""},domProps:{value:e.code},on:{input:function(t){t.target.composing||(e.code=t.target.value)}}}),e._v(" "),o("button",{staticClass:"btn btn-primary text-lg mb-5 focus:outline-none"},[e._v("\n        Продолжить\n      ")]),e._v(" "),o("p",{staticClass:"text-xs text-gray-500 mt-3 cursor-pointer",on:{click:function(t){return e.register("registration_code")}}},[e._v("\n        Отправить код подтверждения повторно\n      ")])]):e._e(),e._v(" "),e.passwordPage?o("form",{staticClass:"flex flex-col bg-gray-300 rounded-lg shadow-md p-2 md:p-8",on:{submit:function(t){return t.preventDefault(),e.showAgreement(t)}}},[o("h2",{staticClass:"mb-5"},[e._v("\n        Введите пароль\n      ")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"input",attrs:{id:"new-password",autocomplete:"new-password",placeholder:"Пароль",type:"password",required:""},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),e._v(" "),o("button",{staticClass:"btn btn-primary text-lg mb-5 focus:outline-none"},[e._v("\n        Завершить регистрацию\n      ")])]):e._e()]),e._v(" "),o("modal",{attrs:{name:"agreement",height:"auto",adaptive:!0}},[o("div",{staticClass:"flex flex-col w-full h-full p-2 text-sm leading-loose"},[o("div",{staticClass:"flex items-center mb-8"},[o("span",{staticClass:"font-bold"},[e._v("Условия сервиса и пользовательское соглашение")]),e._v(" "),o("font-awesome-icon",{staticClass:"cursor-pointer ml-auto",attrs:{icon:"times"},on:{click:e.hideAgreement}})],1),e._v(" "),o("div",{staticClass:"flex flex-col justify-between"},[o("label",{staticClass:"text-gray-500 font-bold mb-4"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.agreement,expression:"agreement"}],staticClass:"mr-2 leading-tight",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.agreement)?e._i(e.agreement,null)>-1:e.agreement},on:{change:function(t){var o=e.agreement,r=t.target,n=!!r.checked;if(Array.isArray(o)){var c=e._i(o,null);r.checked?c<0&&(e.agreement=o.concat([null])):c>-1&&(e.agreement=o.slice(0,c).concat(o.slice(c+1)))}else e.agreement=n}}}),e._v(" "),o("span",{staticClass:"text-sm"},[e._v("\n            Согласен с "),o("a",{staticClass:"text-black",attrs:{href:"#"}},[e._v("условиями сервиса")]),e._v(" и\n            "),o("a",{staticClass:"text-black",attrs:{href:"#"}},[e._v("пользовательским соглашением")])])]),e._v(" "),o("button",{staticClass:"btn btn-primary text-lg mb-5",attrs:{disabled:!e.agreement},on:{click:function(t){return e.register("registration")}}},[e._v("\n          Завершить регистрацию\n        ")])])])])],1)}),[],!1,null,null,null);t.default=component.exports}}]);